---
title: è‡ªåŠ¨åŒ–å¤šçº¿éƒ¨ç½²Hexoåšå®¢
author: admin
type: post
date: 2021-04-07T14:44:21+00:00
url: /55.html
categories:
  - æŠ€æœ¯åˆ†äº«

---
ç°åˆ©ç”¨ Github Action æŒç»­é›†æˆå¹¶éƒ¨ç½² Hexo åšå®¢ã€‚

å¤§è‡´æ€è·¯ï¼š

  * æºç æ–‡ä»¶ Push åˆ° GitHub&nbsp;<code class="prettyprint" >Blog</code>&nbsp;ç§æœ‰ä»“åº“&nbsp;`master`&nbsp;åˆ†æ”¯
  * Github Action åœ¨&nbsp;`Blog`&nbsp;ç§æœ‰ä»“åº“&nbsp;`master`&nbsp;åˆ†æ”¯æ›´æ–°åï¼Œè‡ªåŠ¨æ„å»ºç”Ÿæˆç«™ç‚¹æ–‡ä»¶
  * Github Action å°†ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°&nbsp;`username.github.io`&nbsp;ä»“åº“&nbsp;`master`&nbsp;åˆ†æ”¯
  * äº‘æœåŠ¡å™¨ä» GitHub Page`master`&nbsp;åˆ†æ”¯æ‹‰å–æ›´æ–°

ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªéƒ¨ç½²è¿‡ç¨‹åªéœ€è¦å°†å†™å¥½æºç æ–‡ä»¶ Push åˆ° GitHub ä¸Šå­˜æ”¾æºç ä»“åº“çš„ master åˆ†æ”¯ï¼Œåé¢çš„æ“ä½œäº¤ç»™ Github Action å¤„ç†å³å¯ã€‚

## éƒ¨ç½²åˆ°Github {#éƒ¨ç½²åˆ°Github}

### Githubé…ç½®å¯†é’¥ {#Githubé…ç½®å¯†é’¥}

åœ¨åšå®¢æ ¹ç›®å½•ä¸‹ç”Ÿæˆéƒ¨ç½²å¯†é’¥å¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      ssh-keygen -f deploy-key
    </td>
  </tr>
</table></figure> 

æ ¹ç›®å½•ä¸‹ä¼šæœ‰ç§é’¥&nbsp;<code class="prettyprint" >deploy-key</code>&nbsp;å’Œå…¬é’¥&nbsp;`deploy-key.pub`&nbsp;ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ³¨æ„æ’é™¤ä¿©æ–‡ä»¶ä¸è¦pushåˆ°GitHubå»ã€‚

å¤åˆ¶ç§é’¥&nbsp;<code class="prettyprint" >deploy-key</code>&nbsp;çš„å†…å®¹ï¼Œåœ¨åšå®¢æºç ä»“åº“çš„&nbsp;**Settings â†’ Secrets â†’ New repository secret**&nbsp;æ·»åŠ ã€‚

å…¬é’¥&nbsp;<code class="prettyprint" >deploy-key.pub</code>&nbsp;çš„å†…å®¹ï¼Œåœ¨&nbsp;`username.github.io`&nbsp;ä»“åº“&nbsp;**Settings â†’ Secrets â†’ New repository secret**&nbsp;æ·»åŠ ã€‚

**è‹¥ä»¥ä¸Šç”Ÿæˆçš„å…¬é’¥ã€ç§é’¥Githubè‡ªåŠ¨éƒ¨ç½²å¤±è´¥ï¼Œå¯ç›´æ¥å¤åˆ¶æ‚¨ç”µè„‘ä¸Šçš„å…¬é’¥ã€ç§é’¥é…ç½®ã€‚**

### Githubé…ç½®Action {#Githubé…ç½®Action}

åœ¨å­˜æ”¾ Hexo åšå®¢æºç çš„ç§æœ‰ä»“åº“å¼€å¯&nbsp;<code class="prettyprint" >Action</code>ï¼Œå¹¶åˆ›å»º&nbsp;`.github/workflows/action.yml`&nbsp;é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­&nbsp;`action.yml`&nbsp;åå­—éšæ„å–ã€‚

å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•ä¸”å¯ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œåªéœ€ä¿®æ”¹ Git çš„ç”¨æˆ·åå’Œé‚®ç®±å³å¯ã€‚å¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      # workflow name<br />name: Blog CI<br /><br /># master branch on push, auto run<br />on:<br />push:<br />branches:<br />- master<br /><br />jobs:<br />build:<br />runs-on: ubuntu-latest<br /><br />steps:<br /># check it to your workflow can access it<br /># from: https://github.com/actions/checkout<br />- name: Checkout Repository master branch<br />uses: actions/checkout@master<br /><br /># from: https://github.com/actions/setup-node<br />- name: Setup Node.js 12.x<br />uses: actions/setup-node@master<br />with:<br />node-version: "12.x"<br /><br />- name: Setup Hexo Dependencies<br />run: |<br />npm install hexo-cli -g<br />npm install<br /><br />- name: Setup Deploy Private Key<br />env:<br />HEXO_DEPLOY_PRIVATE_KEY: ${{ secrets.HEXO_DEPLOY_PRIVATE_KEY }}<br />run: |<br />mkdir -p ~/.ssh/<br />echo "$HEXO_DEPLOY_PRIVATE_KEY" > ~/.ssh/id_rsa<br />chmod 600 ~/.ssh/id_rsa<br />ssh-keyscan github.com >> ~/.ssh/known_hosts<br /><br />- name: Setup Git Infomation<br />run: |<br />git config --global user.name 'ç”¨æˆ·å'<br />git config --global user.email 'é‚®ç®±åœ°å€'<br />- name: Deploy Hexo<br />run: |<br />hexo clean<br />hexo generate<br />hexo deploy<br />
    </td>
  </tr>
</table></figure> 

<code class="prettyprint" >action.yml</code>æ–‡ä»¶é…ç½®å¥½å¹¶ä¿å­˜åä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œé…ç½®æ— è¯¯åè‹¥è‡ªåŠ¨éƒ¨ç½²æˆåŠŸåˆ™ä¼šå‡ºç°ç»¿è‰²çš„**âˆš**ã€‚

æ‰“å¼€ä½ çš„&nbsp;<code class="prettyprint" >username.github.io</code>&nbsp;ä»“åº“å³å¯çœ‹åˆ°å·²ç»éƒ¨ç½²æˆåŠŸã€‚

<hr class="wp-block-separator" />

## éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ {#éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨}

### äº‘æœåŠ¡å™¨å®‰è£…Git {#äº‘æœåŠ¡å™¨å®‰è£…Git}

åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤å®‰è£…Gitå¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      yum install git
    </td>
  </tr>
</table></figure> 

### äº‘æœåŠ¡å™¨ç”Ÿæˆå¯†é’¥ {#äº‘æœåŠ¡å™¨ç”Ÿæˆå¯†é’¥}

ä¾æ¬¡æ‰§è¡Œå‘½ä»¤å¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      git config --global user.name "ç”¨æˆ·å"<br />git config --global user.email "é‚®ç®±åœ°å€"<br />ssh-keygen -t rsa -C "é‚®ç®±åœ°å€"
    </td>
  </tr>
</table></figure> 

éªŒè¯æ˜¯å¦é…ç½®æˆåŠŸå¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      ssh -T git@github.com
    </td>
  </tr>
</table></figure> 

### äº‘æœåŠ¡å™¨éƒ¨ç½²å¯†é’¥ {#äº‘æœåŠ¡å™¨éƒ¨ç½²å¯†é’¥}

å°†ç”Ÿæˆçš„ç§é’¥å¤åˆ¶åˆ°<code class="prettyprint" >username.github.io</code>ä»“åº“çš„&nbsp;**Settings â†’ Secrets â†’ New repository secret**&nbsp;å¹¶æ·»åŠ ã€‚

è€Œç”Ÿæˆçš„å…¬é’¥éœ€è¦å¤åˆ¶åˆ° Github çš„è®¾ç½®ä¸­çš„&nbsp;**SSH and GPG keys**&nbsp;çš„&nbsp;**New SSH key**&nbsp;å¤„æ·»åŠ ã€‚

### Pullåˆ°äº‘æœåŠ¡å™¨ {#Pullåˆ°äº‘æœåŠ¡å™¨}

åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤åˆå§‹åŒ– Git ä»“åº“å¹¶æ‹‰å–æ–‡ä»¶ã€‚å¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      #Toç«™ç‚¹ç›®å½•<br />cd /www/wwwroot/blog<br />#åˆå§‹åŒ–git<br />git init<br />#æ·»åŠ è¿œç¨‹ä»“åº“<br />git remote add origin git@github.com:username/username.github.io.git<br />#è·å–è¿œç«¯æ›´æ–°<br />git fetch origin<br />#pullè¿œç«¯ä»£ç åˆ°æœ¬åœ°<br />git pull<br />#å¦‚æœæŠ¥é”™ï¼šrefusing to merge unrelated historiesï¼Œåˆ™ç”¨ä¸‹é¢çš„å‘½ä»¤<br />git pull --allow-unrelated-histories<br />#æˆ–è€…ç›´æ¥Gitè¿œç«¯è¦†ç›–æœ¬åœ°<br />git reset --hard origin/master
    </td>
  </tr>
</table></figure> 

åœ¨äº‘æœåŠ¡å™¨å®å¡”é¢æ¿ä¸Šå¼€å¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å³å¯ï¼Œshellè„šæœ¬ä¸ºå¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      cd /www/wwwroot/blog<br />git remote add origin git@github.com:username/username.github.io.git<br />git fetch origin<br />git reset --hard origin/master
    </td>
  </tr>
</table></figure> 

è¿™æ ·äº‘æœåŠ¡å™¨å°±èƒ½å®šæ—¶æ›´æ–°é™æ€ç«™å†…å®¹ï¼Œè€Œä¸ç”¨æ‰‹åŠ¨æ“ä½œäº†ã€‚

## ç»“æŸè¯­ {#ç»“æŸè¯­}

å½“å®Œæˆä»¥ä¸Šé…ç½®ä»¥åï¼Œæ›´æ–°æ–‡ç« åªéœ€ä¿®æ”¹æºä»£ç åï¼Œæ‰§è¡Œå‘½ä»¤ä¸‰è¿å¤åˆ¶<figure class="wp-block-table">

<table>
  <tr>
    <td>
      git add .<br />git commit<br />git push
    </td>
  </tr>
</table></figure> 

**PS: é»˜è®¤å·²ç»åˆå§‹åŒ–è¿‡æœ¬åœ°ä»“åº“**

å‰©ä¸‹çš„ç”Ÿæˆé™æ€æ–‡ä»¶ã€éƒ¨ç½²åˆ°é™æ€æ–‡ä»¶ä»“åº“å’Œäº‘æœåŠ¡å™¨ä»“åº“çš„ä»»åŠ¡å°±äº¤ç»™ Github Action å’Œ Shell è„šæœ¬å³å¯ã€‚

åŒæ‰‹ç¬é—´è½»æ¾äº†å¾ˆå¤šå•ŠğŸ‘ŒğŸ¤£